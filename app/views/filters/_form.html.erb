<h1>Add New Filter</h1>
<%= form_for(@filter) do |f| %>
  <div class="form-group control-group belongs_to_association_type user_field col-sm-10">
    <%= f.label :name, class: "col-sm-2 control-label" %>
    <div class="col-sm-8 controls">
      <%= f.text_field :name, class: "form-control", required: true  %>
    </div>
  </div>
  <div class="form-group control-group belongs_to_association_type user_field col-sm-10">
    <%= f.label :family, class: "col-sm-2 control-label" %>
    <div class="col-sm-8 controls">
      <%= f.text_field :family, class: "form-control", required: true  %><br />
    </div>
  </div>
  <div class="form-group control-group belongs_to_association_type user_field col-sm-10">
    <%= f.label :segment, class: "col-sm-2 control-label" %>
    <%= f.select :segment,options_for_select(Filter::SEGMENT), class: "form-control"%>
  </div>
  <div class="form-group control-group belongs_to_association_type user_field col-sm-10">
    <%= f.label :operator, class: "col-sm-2 control-label" %>
    <%= f.select :operator,options_for_select(Filter::RELATION_OPERATOR), class: "form-control" %><br />
  </div>
  <div class="form-group control-group belongs_to_association_type user_field col-sm-10">
    <%= f.label :list_type, class: "col-sm-2 control-label" %>
    <%= f.select :list_type, options_for_select(Filter::LIST_KEYS.invert.to_a),{ id: 'filter_list_type', class: "form-control" }%>
  </div>
  <div class="form-group control-group belongs_to_association_type user_field col-sm-10">
    <%= f.label :condition, class: "col-sm-2 control-label" %>
    <%= f.select :condition, options_for_select(Filter::RELATION_OPERATOR), { id: 'filter_condition', class: "form-control" } %><br />
  </div>
  <div class="form-group control-group belongs_to_association_type user_field col-sm-10">
    <%= f.label :start_date, class: "col-sm-2 control-label" %>
    <div class="col-sm-8 controls">
      <%= f.text_field :start_date, class: "form-control",:placeholder => "yyyy-mm-dd" %><br />
  </div>
  </div>
  <div class="form-group control-group belongs_to_association_type user_field col-sm-10">
    <%= f.label :end_date, class: "col-sm-2 control-label" %>
    <div class="col-sm-8 controls">
      <%= f.text_field :end_date, class: "form-control" ,:placeholder => "yyyy-mm-dd"  %><br />
    </div>
  </div>
  <div class="form-group control-group belongs_to_association_type user_field col-sm-10">
    <%= f.submit %>
  </div>
<% end %>

<script type="text/javascript">
  $(function() {
  return $(document).on('change', '#filter_list_type', function(evt) {
    return $.ajax({
      url: '/filters/get_list',
      type: 'GET',
      dataType: 'script',
      data: {
        list_type: $("#filter_list_type option:selected").val()
      },
      error: function(jqXHR, textStatus, errorThrown) {
        return console.log("AJAX Error: " + textStatus);
      },
      success: function(data, textStatus, jqXHR) {
        return console.log("Dynamic List select OK!");
      }
    });
  });
});
$(function() {
  return $(document).on('change', '#filter_segment', function(evt) {
    var list_val = $("#filter_segment option:selected").val()
    switch (list_val) {
    case "categories":
        list_type = "category_list";
        break;
    case "downloaded_the_app":
        list_type = "numeric_operator_list";
        break;
    case "feeling_score":
        list_type = "feeling_score_list";
        break;
    case"impact_score":
        list_type = "impact_score_list";
        break;
    case "well_being_score":
        list_type = "well_being_score_list";
        break;
    case "weather_condition":
        list_type = "weather_condition_list";
        break;
    default: 
        list_type = "recency_list";
        break;
}
    console.log(list_type)
    return $.ajax({
      url: '/filters/get_collective_list',
      type: 'GET',
      dataType: 'script',
      data: {
        list_type: list_type //$("#filter_list_type option:selected").val()
      },
      error: function(jqXHR, textStatus, errorThrown) {
        return console.log("AJAX Error: " + textStatus);
      },
      success: function(data, textStatus, jqXHR) {
        return console.log("Dynamic collective_list select OK!");
      }
    });
  });
});

</script>